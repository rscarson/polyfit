use polyfit::{plot, score::Aic, statistics::{Confidence, DegreeBound}, MonomialFit};

const DATA: &[(f64, f64)] = &[
    (0.000998,-0.020518),
    (0.001991, -0.017432),
    (0.002979, -0.019766),
    (0.003963, -0.018885),
    (0.004942, -0.018763),
    (0.005916, -0.017554),
    (0.006886, -0.017992),
    (0.007851, -0.018387),
    (0.008812, -0.018551),
    (0.009769, -0.019189),
    (0.010721, -0.018923),
    (0.011669, -0.016935),
    (0.012612, -0.017815),
    (0.013551, -0.021563),
    (0.014486, -0.020287),
    (0.015417, -0.017545),
    (0.016343, -0.017798),
    (0.017265, -0.016901),
    (0.018183, -0.016596),
    (0.019097, -0.016575),
    (0.020006, -0.018382),
    (0.020912, -0.018727),
    (0.021813, -0.017071),
    (0.022710, -0.017170),
    (0.023604, -0.017264),
    (0.024493, -0.014923),
    (0.025379, -0.016613),
    (0.026260, -0.020250),
    (0.027138, -0.018576),
    (0.028011, -0.018705),
    (0.028881, -0.016713),
    (0.029747, -0.017179),
    (0.030609, -0.017687),
    (0.031468, -0.016868),
    (0.032323, -0.017960),
    (0.033173, -0.016613),
    (0.034021, -0.018045),
    (0.034864, -0.016431),
    (0.035704, -0.017691),
    (0.036540, -0.016806),
    (0.037373, -0.015793),
    (0.038202, -0.015950),
    (0.039027, -0.013781),
    (0.039849, -0.017243),
    (0.040667, -0.015238),
    (0.041482, -0.015789),
    (0.042294, -0.016592),
    (0.043102, -0.016491),
    (0.043906, -0.017361),
    (0.044707, -0.015730),
    (0.045505, -0.013302),
    (0.046299, -0.017243),
    (0.047090, -0.013804),
    (0.047878, -0.014149),
    (0.048662, -0.014032),
    (0.049443, -0.016207),
    (0.050221, -0.016797),
    (0.050995, -0.012377),
    (0.051766, -0.013339),
    (0.052534, -0.013450),
    (0.053299, -0.012393),
    (0.054061, -0.015195),
    (0.054819, -0.012801),
    (0.055575, -0.013487),
    (0.056327, -0.013002),
    (0.057076, -0.016044),
    (0.057822, -0.014581),
    (0.058565, -0.011765),
    (0.059306, -0.014938),
    (0.060043, -0.011717),
    (0.060777, -0.014656),
    (0.061508, -0.014169),
    (0.062236, -0.011467),
    (0.062961, -0.015249),
    (0.063683, -0.013415),
    (0.064402, -0.013733),
    (0.065119, -0.015287),
    (0.065832, -0.012839),
    (0.066543, -0.014884),
    (0.067250, -0.012704),
    (0.067955, -0.015693),
    (0.068658, -0.009002),
    (0.069357, -0.011647),
    (0.070053, -0.013810),
    (0.070747, -0.013847),
    (0.071438, -0.013104),
    (0.072127, -0.014404),
    (0.072812, -0.013158),
    (0.073495, -0.013573),
    (0.074176, -0.011467),
    (0.074853, -0.010903),
    (0.075528, -0.013612),
    (0.076200, -0.012469),
    (0.076870, -0.014072),
    (0.077537, -0.011334),
    (0.078202, -0.013151),
    (0.078864, -0.012762),
    (0.079523, -0.013552),
    (0.080180, -0.012956),
    (0.080834, -0.013511),
];

const DATA2: &[(f64, f64)] = &[
    (0.0, -0.014150 * 1000.0),
    (1.0, -0.007723 * 1000.0),
    (2.0, 0.000702 * 1000.0),
    (3.0, 0.004458 * 1000.0),
];

fn main() {
    let mut fit = MonomialFit::new_auto(DATA, DegreeBound::Relaxed, &Aic).unwrap();
    fit.prune_insignificant(Confidence::P95).unwrap();
    println!("{fit}");

    let mut fit2 = MonomialFit::new_auto(DATA2, DegreeBound::Relaxed, &Aic).unwrap();
    fit2.prune_insignificant(Confidence::P95).unwrap();
    println!("{fit2}");
    plot!(fit);
}